<script src="jquery.min.js"></script>
<script>
var jsonld = {
  "@graph" : [ {
    "@id" : "DBLP",
    "@type" : "void:Dataset",
    "subject" : [ "http://dbpedia.org/resource/Proceedings", "http://dbpedia.org/resource/Journal", "http://dbpedia.org/resource/Computer_science" ],
    "homepage" : "http://www4.wiwiss.fu-berlin.de/dblp/all"
  }, 
  {
    "@id" : "DBpedia",
    "@type" : "void:Dataset",
    "homepage" : "http://dbpedia.org/"
  }, 
  {
    "@id" : "LinkedMDB",
    "@type" : "void:Dataset",
    "homepage" : "http://linkedmdb.org/"
  }, 
  {
    "@id" : "Bio2RDF",
    "@type" : "void:Dataset",
    "homepage" : "http://bio2rdf.org/"
  }, 
  {
    "@id" : "DBpedia2DBLP",
    "@type" : "void:Linkset",
    "target" : [ "DBLP", "DBpedia" ]
  }, 
  {
    "@id" : "Bio2RDF2DBLP",
    "@type" : "void:Linkset",
    "target" : [ "Bio2RDF", "DBpedia" ]
  }, 
  {
    "@id" : "DBLP2DBpedia",
    "@type" : "void:Linkset",
    "target" : [ "DBpedia", "DBLP" ]
  }, 
  {
    "@id" : "LinkedMDB_DBpedia",
    "@type" : "void:Linkset",
    "target" : [ "LinkedMDB", "DBpedia" ]
  } 
  ],
  "@context" : {
    "subset" : {
      "@id" : "http://rdfs.org/ns/void#subset",
      "@type" : "@id"
    },
    "homepage" : {
      "@id" : "http://xmlns.com/foaf/0.1/homepage",
      "@type" : "@id"
    },
    "subject" : {
      "@id" : "http://purl.org/dc/terms/subject",
      "@type" : "@id"
    },
    "target" : {
      "@id" : "http://rdfs.org/ns/void#target",
      "@type" : "@id"
    },
    "@base" : "http://example.com/",
    "rdfs" : "http://www.w3.org/2000/01/rdf-schema#",
    "foaf" : "http://xmlns.com/foaf/0.1/",
    "sd" : "http://www.w3.org/ns/sparql-service-description#",
    "xsd" : "http://www.w3.org/2001/XMLSchema#",
    "owl" : "http://www.w3.org/2002/07/owl#",
    "rdf" : "http://www.w3.org/1999/02/22-rdf-syntax-ns#",
    "void" : "http://rdfs.org/ns/void#",
    "wv" : "http://vocab.org/waiver/terms/norms",
    "dcterms" : "http://purl.org/dc/terms/"
  }
};


</script>
<style>
.circle {
    z-index: 1;
    position: absolute;
}
.circle .inner
{
    height: 100px;
    width: 100px;
    display: table-cell;
    text-align: center;
    vertical-align: middle;
    border-radius: 50%;
    background: #fff;
    border: 1px solid #316CC3;
    font-size: 14px;
    font-family: Tahoma;

-webkit-box-shadow: 10px 10px 51px -29px rgba(0,0,0,0.75);
-moz-box-shadow: 10px 10px 51px -29px rgba(0,0,0,0.75);
box-shadow: 10px 10px 51px -29px rgba(0,0,0,0.75);
}
.arrow {
width: 120px;
height: 6px;
position: absolute;

}

.line {
width: 100%;
background: #000;
height: 1px;
top: 50%;
margin-top: -0.5px;
position: absolute;
}
.point {    
width: 0;
height: 0;
border-top: 3px solid transparent;
border-bottom: 3px solid transparent;
border-left: 14px solid #000;
position: absolute;

}
.point.right {
right: -5px;
}
.point.left {
transform: rotate(180deg);
-ms-transform: rotate(180deg);
-webkit-transform: rotate(180deg);
left: -5px;
}
</style>
<script>
function createCircle(text, zoom) {
    var $circle = $('#tmpl .circle').clone();
    $circle.find('.inner').text(text);
    if(zoom) {
        $circle.css({zoom:zoom});
    }
    return $circle;
}
function getCenter($circle) {
    var pos = $circle.position();

    var width = $circle.width();
    var height = $circle.height();

    return { top: (pos.top + (height / 2)), left: (pos.left + (width/2)) };
}
function connect($c1, $c2, color, thickness) {
    var center1 = getCenter($c1);
    var center2 = getCenter($c2);

    // bottom right
    var x1 = center1.left;
    var y1 = center1.top;
    // top right
    var x2 = center2.left;
    var y2 = center2.top;
    // distance
    var length = Math.sqrt(((x2-x1) * (x2-x1)) + ((y2-y1) * (y2-y1)));
    // center
    var cx = ((x1 + x2) / 2) - (length / 2);
    var cy = ((y1 + y2) / 2) - (thickness / 2);
    // angle
    var angle = Math.atan2((y1-y2),(x1-x2))*(180/Math.PI);
    // make arrow
    var $arrow = $("<div class='arrow' style='padding:0px; margin:0px; position:absolute; left:" + cx + "px; top:" + cy + "px; width:" + length + "px; -moz-transform:rotate(" + angle + "deg); -webkit-transform:rotate(" + angle + "deg); -o-transform:rotate(" + angle + "deg); -ms-transform:rotate(" + angle + "deg); transform:rotate(" + angle + "deg);'><div class='line'></div><div class='point right' style='right: "+(($c2.width()/2)-4)+"px'></div></div>");
        
    $(document.body).append($arrow);
}


var min_x = 0;
var max_x = 700;
var min_y = 0;
var max_y = 400;
var filled_areas = [];
function check_overlap(area) {
    for (var i = 0; i < filled_areas.length; i++) {
        
        check_area = filled_areas[i];
        
        var bottom1 = area.y + area.height;
        var bottom2 = check_area.y + check_area.height;
        var top1 = area.y;
        var top2 = check_area.y;
        var left1 = area.x;
        var left2 = check_area.x;
        var right1 = area.x + area.width;
        var right2 = check_area.x + check_area.width;
        if (bottom1 < top2 || top1 > bottom2 || right1 < left2 || left1 > right2) {
            continue;
        }
        return true;
    }
    return false;
}
$(function() {

var graph = jsonld['@graph'];
for(var i=0; i<graph.length; i++) {
    var obj = graph[i];
    if(obj['@type'] == 'void:Dataset') {
        var circle = createCircle(obj['@id'], 1)
        circle.addClass(obj['@id']);
        $(document.body)
            .append(circle)

        var rand_x=0;
        var rand_y=0;
        var area;
        do {
            rand_x = Math.round(min_x + ((max_x - min_x)*(Math.random() % 1)));
            rand_y = Math.round(min_y + ((max_y - min_y)*(Math.random() % 1)));
            area = {x: rand_x, y: rand_y, width: circle.width(), height: circle.height()};
        } while(check_overlap(area));

        filled_areas.push(area);

        circle.css({left:rand_x, top: rand_y});

    } else if(obj['@type'] == 'void:Linkset') {
        connect($('.circle.'+obj.target[0]), $('.circle.'+obj.target[1]), '#0f0', 5);
    }

}


});

</script>
<div id="tmpl" style="display: none">
    <div class="circle"><div class="inner">Music-<br>brainz</div></div>
    <div class="arrow">
        <div class="line"></div>
        <div class="point right"></div>
    </div>
    <!--
    <div class="arrow">
        <div class="line"></div>
        <div class="point right"></div>
        <div class="point left"></div>
    </div>
    -->
</div>

